{
  "variables": {
    "template": "centos-7.2-x86_64",
    "template_os": "centos-64",

    "debug": "false",
    "headless": "true",

    "iso_url": "file:///Users/dan/stuff/iso/os/centos/centos7.2x86_64/CentOS-7-x86_64-DVD-1511.iso",
    "iso_checksum": "907e5755f824c5848b9c8efbb484f3cd945e93faa024bad6ba875226f9683b16",
    "iso_checksum_type": "sha256",

    "installer_boot_time": "5s",

    "vmware_hardware_version": "9",
    "memory_size": "512",
    "cpu_count": "1",
    "vmtools_iso_path": "/tmp/vmware-tools.iso",

    "ssh_private_key": "/Users/dan/.ssh/vagrant.id_rsa"

  },

  "builders": [
    {
      "type": "vmware-iso",
      "http_directory": "http",
      "communicator": "ssh",
      "output_directory": "output-{{user `template`}}-{{build_type}}",
      "headless": "{{user `headless`}}",

      "iso_url": "{{user `iso_url`}}",
      "iso_checksum": "{{user `iso_checksum`}}",
      "iso_checksum_type": "{{user `iso_checksum_type`}}",

      "boot_command": [
        "<tab> <wait>",
        "text ks=http://{{ .HTTPIP }}:{{ .HTTPPort }}/ks.cfg <wait>",
        "<enter> <wait>"
      ],
      "boot_wait": "{{user `installer_boot_time`}}",

      "version": "{{user `vmware_hardware_version`}}",
      "guest_os_type": "{{user `template_os`}}",
      "vmx_data": {
        "displayName": "Packer-{{user `template`}}",
        "memsize": "{{user `memory_size`}}",
        "numvcpus": "{{user `cpu_count`}}",
        "cpuid.coresPerSocket": "1",
        "mks.enable3d": "FALSE",
        "serial0.present": "FALSE",
        "sound.present": "FALSE",
        "floppy0.present": "FALSE",
        "usb.present": "FALSE",
        "usb.vbluetooth.startConnected": "FALSE"
      },
      "vm_name": "{{user `template`}}",
      "vmdk_name": "{{user `template`}}",
      "disk_type_id": "0",
      "disk_size": 10240,
      "tools_upload_flavor": "linux",
      "tools_upload_path": "{{user `vmtools_iso_path`}}",

      "ssh_username": "coadmin",
      "ssh_private_key_file": "{{user `ssh_private_key`}}",

      "shutdown_command": "sudo /sbin/poweroff"
    }
  ],

  "provisioners": [
    {
      "type": "shell",
      "environment_vars": [
        "VMTOOLS_ISO_PATH={{user `vmtools_iso_path`}}",
        "DEBUG={{user `debug`}}"
      ],
      "execute_command": "{{ .Vars }} sudo -E sh '{{.Path }}'",
			"override": {
				"vmware-iso": {
					"scripts": [
            "scripts/00-yum-update.sh",
            "scripts/01-remove-old-kernels.sh",
            "scripts/02-disable-system-beep.sh",
            "scripts/03-install-open-vm-tools.sh",
            "scripts/04-install-vmware-tools.sh",
            "scripts/05-zero-free-space.sh"
          ]
        }
      }
    }
  ]

}
